# Enable any key to escape terminal freeze
stty ixany
# original Ctrl-S : froze, Ctrl-Q continue
# disable stty -ixon

# If not running interactively, don't do anything
[[ $- != *i* ]] && return

# Oh-my-bash 
# Eager loading to overwrite its settings (.oh-my-bash/lib/history : HISTIGNORE)
#  w/o editing/pushing changes
# [[ -f ~/.bash_omb ]] && . ~/.bash_omb

# BASH OPTIONS
shopt -s autocd                  # Change path w/o using cd
shopt -s cdspell                 # Correct cd typos
shopt -s checkwinsize            # Update windows size on command
shopt -s histappend              # Append history instead of overwriting file
shopt -s cmdhist                 # Bash attempts to save all lines of a multiple-line command in the same history entry
shopt -s extglob                 # Extended pattern
shopt -s expand_aliases          # expand aliases
shopt -s no_empty_cmd_completion # No empty completion

bind "set completion-ignore-case on" #ignore upper and lowercase when TAB completion

# EXPORT
export PATH=/usr/local/bin:$PATH
[[ -d "$HOME/bin" ]] && PATH="$HOME/bin:$PATH"

export TERM='xterm-256color'
export EDITOR=nvim
export VISUAL=$EDITOR

# BASH HISTORY
export HISTSIZE=1000                    # bash history will save N commands
export HISTFILESIZE=${HISTSIZE}         # bash will remember N commands
export HISTCONTROL=ignoreboth:erasedups # ignore duplicates and spaces
export HISTIGNORE='&:l[sla]*:cd*:exit:clear:history*'

export MANPAGER="nvim -c 'set ft=man' -"

# PROMPT
# PS1='[\u@\h \W]\$ '
PS1='\W\$ '

# TERMINAL TITLE
case ${TERM} in
  xterm*|rxvt*|Eterm*|aterm|kterm|gnome*|alacritty|st|konsole*)
    PROMPT_COMMAND='echo -ne "\033]0;${USER}@${HOSTNAME%%.*}:${PWD/#$HOME/\~}\007"'
    ;;
  screen*)
    PROMPT_COMMAND='echo -ne "\033_${USER}@${HOSTNAME%%.*}:${PWD/#$HOME/\~}\033\\"'
    ;;
esac

# ALIAS
alias pacman='sudo pacman'
alias sudo='sudo '
alias scat='sudo cat'
alias svim='sudo vim'
alias root='sudo su'
alias reboot='sudo reboot'
alias halt='sudo halt'

alias dir='dir --color=auto'
alias vdir='vdir --color=auto'
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'

alias ed="nvim"
alias vi="ed"
alias vim="ed"

alias ..='cd ..'
alias df='df -h'
alias diff='colordiff'              # requires colordiff package
alias du='du -c -h'
alias free='free -m'                # show sizes in MB
alias grep='grep --color=tty -d skip'
alias mkdir='mkdir -p -v'
alias more='less'
alias nano='nano -w'
alias ping='ping -c 5'
  
alias ls='ls -hF --color=auto'
alias lr='ls -R'                    # recursive ls
alias ll='ls -alh'
alias la='ll -A'
alias lm='la | less'

alias less='/usr/share/nvim/runtime/macros/less.sh $1'

alias rm='rm -I'
alias mv='mv -i'

alias lx='ll -BX'        # sort by extension
alias lz='ll -rS'        # sort by size
alias lt='ll -rt'        # sort by date

alias da='date "+%A, %B %d, %Y [%T]"'
alias du1='du --max-depth=1'
alias hist='history | grep $1'
alias openports='netstat --all --numeric --programs --inet --inet6'
alias pss='ps -Af | grep $1'

alias NoHist="unset HISTFILE"

alias cm='chezmoi'
alias config='cm edit $1'


# NumLock ON - works after login
# setleds -D +num

# [[ -f ~/.bash_aliases ]] && . ~/.bash_aliases
[[ -f ~/.bash_functions ]] && . ~/.bash_functions
[[ -f ~/.bash_paths ]] && . ~/.bash_paths

[[ -f ~/.nnn ]] && . ~/.nnn

[[ -f /usr/share/nvm/init-nvm.sh ]] && . /usr/share/nvm/init-nvm.sh

eval "$(oh-my-posh --init --shell bash --config ~/cav.omp.json)"

